<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>knz_bison - Konza Prairie Bison Weights (KNZ) • lterdatasampler</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="knz_bison - Konza Prairie Bison Weights (KNZ)">
<meta property="og:description" content="lterdatasampler">
<meta property="og:image" content="https://lter.github.io/lterdatasampler/reference/figures/leaf.png">
<meta property="og:image:alt" content="lterdatasampler package in R">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@allison_horst">
<meta name="twitter:site" content="@allison_horst">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lterdatasampler</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/and_vertebrates_vignette.html">and_vertebrates - Andrews Forest LTER Mack Creek cutthroat trout and salamanders (AND)</a>
    </li>
    <li>
      <a href="../articles/arc_weather_vignette.html">arc_weather - Arctic LTER Toolik Field Station (ARC)</a>
    </li>
    <li>
      <a href="../articles/hbr_maples_vignette.html">hbr_maples - Hubbard Brook Experimental Forest Sugar Maples (HBR)</a>
    </li>
    <li>
      <a href="../articles/knz_bison_vignette.html">knz_bison - Konza Prairie Bison Weights (KNZ)</a>
    </li>
    <li>
      <a href="../articles/luq_streamchem_vignette.html">luq_streamchem - Stream chemistry, Luquillo Mountains of Puerto Rico (LUQ)</a>
    </li>
    <li>
      <a href="../articles/ntl_icecover_vignette.html">ntl_icecover - North Temperate Lakes Ice Cover (NTL)</a>
    </li>
    <li>
      <a href="../articles/nwt_pikas_vignette.html">nwt_pikas - Niwot Ridge Pika Locations (NWT)</a>
    </li>
    <li>
      <a href="../articles/pie_crab_vignette.html">pie_crab - Plum Island Ecosystem LTER fiddler crabs (PIE)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/lter/lterdatasampler/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>knz_bison - Konza Prairie Bison Weights
(KNZ)</h1>
            <h3 data-toc-skip class="subtitle">Historical records of
end-of-season weights for individual bison at Konza Prairie Biological
Station LTER</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lter/lterdatasampler/blob/HEAD/vignettes/articles/knz_bison_vignette.Rmd" class="external-link"><code>vignettes/articles/knz_bison_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>knz_bison_vignette.Rmd</code></div>

    </div>

    
    
<div class="section level4">
<h4 id="dataset-sample-used">Dataset sample used<a class="anchor" aria-label="anchor" href="#dataset-sample-used"></a>
</h4>
<ul>
<li><code>knz_bison</code></li>
</ul>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>knz_bison</code> data provides age and weight records for
the bison herd at <a href="http://lter.konza.ksu.edu/konza-prairie-long-term-ecological-research-lter" class="external-link">Konza
Prairie Biological Station LTER</a> (KPBS) in Kansas.</p>
<p>The vignette highlights:</p>
<ul>
<li>An example of modeling bison weight (as a function of age) using the
Gompertz model with <code>nls</code>
</li>
<li>Use of the <code>broom</code> package to tidy up outputs of
<code>nls</code> for easier use</li>
</ul>
<p>From Konza Prairie LTER Researcher Jeffrey Taylor: “Nearly 300 bison
graze KPBS year-round without supplementary feed and with minimal human
intervention, living as ‘naturally’ as possible. Bison were reintroduced
in 1987, and collection of weight data began in 1994, making this
dataset the longest continuous record of wild ungulate weight gain
anywhere in the world. A round-up is conducted once annually at the end
of the grazing season wherein each bison is weighed, calves are
vaccinated and receive unique IDs, and excess individuals are
culled.”</p>
<figure style="text-align:center;"><img src="../reference/figures/knz_bison_img.jpg" width="80%" style="display:block; margin-left: auto; margin-right: auto;"><figcaption>
Konza Prairie LTER bison herd, LTER CC BY-SA 4.0
</figcaption></figure><figure style="text-align:center;"><img src="../reference/figures/knz_bison_img_2.jpg" width="80%" style="display:block; margin-left: auto; margin-right: auto;"><figcaption>
Konza Prairie LTER bison in chute for data collection, LTER CC BY-SA 4.0
</figcaption></figure><figure style="text-align:center;"><img src="../reference/figures/knz_bison_img_3.jpg" width="80%" style="display:block; margin-left: auto; margin-right: auto;"><figcaption>
Bison exiting chute following data collection, Konza Prairie LTER, LTER
CC BY-SA 4.0
</figcaption></figure>
</div>
<div class="section level2">
<h2 id="data-exploration">Data exploration<a class="anchor" aria-label="anchor" href="#data-exploration"></a>
</h2>
<p>Attach required packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lter/lterdatasampler" class="external-link">lterdatasampler</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span></span></code></pre></div>
<p>Let’s take a look at the existing <code>knz_bison</code> data
sample:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">knz_bison</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 8,325 × 8</span></span></span>
<span><span class="co">##    data_code rec_year rec_month rec_day animal_code animal_sex animal_weight</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> CBH01         <span style="text-decoration: underline;">1</span>994        11       8 813         F                    890</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> CBH01         <span style="text-decoration: underline;">1</span>994        11       8 834         F                   <span style="text-decoration: underline;">1</span>074</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> CBH01         <span style="text-decoration: underline;">1</span>994        11       8 B-301       F                   <span style="text-decoration: underline;">1</span>060</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> CBH01         <span style="text-decoration: underline;">1</span>994        11       8 B-402       F                    989</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> CBH01         <span style="text-decoration: underline;">1</span>994        11       8 B-403       F                   <span style="text-decoration: underline;">1</span>062</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> CBH01         <span style="text-decoration: underline;">1</span>994        11       8 B-502       F                    978</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> CBH01         <span style="text-decoration: underline;">1</span>994        11       8 B-503       F                   <span style="text-decoration: underline;">1</span>068</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> CBH01         <span style="text-decoration: underline;">1</span>994        11       8 B-504       F                   <span style="text-decoration: underline;">1</span>024</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> CBH01         <span style="text-decoration: underline;">1</span>994        11       8 B-601       F                    978</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> CBH01         <span style="text-decoration: underline;">1</span>994        11       8 B-602       F                   <span style="text-decoration: underline;">1</span>188</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 8,315 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: animal_yob &lt;dbl&gt;</span></span></span></code></pre>
<p>We can calculate each bison’s age at observation by subtracting the
year of birth (<code>animal_yob</code>) from the record year
(<code>rec_year</code>), adding a new column called
<code>animal_age</code> using <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">knz_bison_age</span> <span class="op">&lt;-</span> <span class="va">knz_bison</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>animal_age <span class="op">=</span> <span class="va">rec_year</span> <span class="op">-</span> <span class="va">animal_yob</span><span class="op">)</span></span></code></pre></div>
<p>Now, we’ll explore bison weight as a function of age (in years),
separated by sex:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">knz_bison_age</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">animal_age</span>, y <span class="op">=</span> <span class="va">animal_weight</span>, group <span class="op">=</span> <span class="va">animal_sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">animal_sex</span><span class="op">)</span>, </span>
<span>             size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>             position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Bison age (years)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Recorded weight (pounds)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 252 rows containing missing values (`geom_point()`).</span></span></code></pre>
<p><img src="knz_bison_vignette_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="gompertz-model-with-nonlinear-least-squares">Gompertz model (with nonlinear least squares)<a class="anchor" aria-label="anchor" href="#gompertz-model-with-nonlinear-least-squares"></a>
</h2>
<p>As used by Martin and Barboza (2020), bison body mass as a function
of age can be modeled using a sex-specific Gompertz model:</p>
<p><span class="math display">\[BM =b1*exp(-exp(-b2*(age-b3)))\]</span>
Where <span class="math inline">\(b1\)</span> is the <em>asymptotic body
mass</em> (pounds), <span class="math inline">\(b2\)</span> is
instantaneous growth-rate at inflection point, and <span class="math inline">\(b3\)</span> is age at inflection point
(years).</p>
<p>Using nonlinear least squares (nls) to estimate <span class="math inline">\(b1\)</span>, <span class="math inline">\(b2\)</span> and <span class="math inline">\(b3\)</span> requires starting estimates for each.
We will use the following (based on visualizations above, and estimates
from Supplemental Materials for Martin and Barbosa (2020):</p>
<div class="section level4">
<h4 id="female-bison-parameter-initial-estimates">Female bison parameter initial estimates:<a class="anchor" aria-label="anchor" href="#female-bison-parameter-initial-estimates"></a>
</h4>
<ul>
<li>
<span class="math inline">\(b1\)</span> initial estimate: 1000
pounds</li>
<li>
<span class="math inline">\(b2\)</span> initial estimate: 1</li>
<li>
<span class="math inline">\(b3\)</span> initial estimate: 0.6</li>
</ul>
</div>
<div class="section level3">
<h3 id="create-the-gompertz-model-function">Create the Gompertz model function:<a class="anchor" aria-label="anchor" href="#create-the-gompertz-model-function"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gompertz</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">b1</span>, <span class="va">b2</span>, <span class="va">b3</span>, <span class="va">animal_age</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">b1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">b2</span><span class="op">*</span><span class="op">(</span><span class="va">animal_age</span><span class="op">-</span><span class="va">b3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="use-nls-to-model-growth-for-female-bison">Use <code>nls()</code> to model growth for female bison<a class="anchor" aria-label="anchor" href="#use-nls-to-model-growth-for-female-bison"></a>
</h3>
<p>Isolate just the female bison (note that this starts from the dataset
<code>knz_bison_age</code> created above that contains the calculated
bison <strong>age</strong>, stored as <code>animal_age</code>):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bison_f</span> <span class="op">&lt;-</span> <span class="va">knz_bison_age</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">animal_sex</span> <span class="op">==</span> <span class="st">"F"</span><span class="op">)</span></span></code></pre></div>
<p>Use <code>nls</code> to estimate parameters (note: add
<code>trace = TRUE</code> to print iterative estimates):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bison_f_gompertz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a></span><span class="op">(</span><span class="va">animal_weight</span> <span class="op">~</span> <span class="fu">gompertz</span><span class="op">(</span><span class="va">b1</span>, <span class="va">b2</span>, <span class="va">b3</span>, <span class="va">animal_age</span><span class="op">)</span>,</span>
<span>                        data <span class="op">=</span> <span class="va">bison_f</span>,</span>
<span>                        start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>b1 <span class="op">=</span> <span class="fl">1000</span>, b2 <span class="op">=</span> <span class="fl">1</span>, b3 <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>,</span>
<span>                        trace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 5.291715e+07 (7.61e-01): par = (1000 1 0.6)</span></span>
<span><span class="co">## 3.442663e+07 (1.91e-01): par = (1007.201 0.6930941 0.3444975)</span></span>
<span><span class="co">## 3.320797e+07 (7.02e-03): par = (1009.67 0.7250854 0.2798164)</span></span>
<span><span class="co">## 3.320631e+07 (1.28e-04): par = (1009.764 0.727529 0.2832794)</span></span>
<span><span class="co">## 3.320631e+07 (3.10e-06): par = (1009.756 0.7275973 0.2832921)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="plot-the-predicted-masses-with-the-observed-data">Plot the predicted masses with the observed data<a class="anchor" aria-label="anchor" href="#plot-the-predicted-masses-with-the-observed-data"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a new series of ages</span></span>
<span><span class="va">age_series</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">22</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make predictions using the model over those times: </span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bison_f_gompertz</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>animal_age <span class="op">=</span> <span class="va">age_series</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Bind the predictions and age sequence together into a data frame: </span></span>
<span><span class="va">bison_f_predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">age_series</span>, <span class="va">pred</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the observed data and predictions together:</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bison_f</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">animal_age</span>, y <span class="op">=</span> <span class="va">animal_weight</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>             alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bison_f_predicted</span>, </span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age_series</span>, y <span class="op">=</span> <span class="va">pred</span><span class="op">)</span>,</span>
<span>            color <span class="op">=</span> <span class="st">"darkorchid"</span>,</span>
<span>            size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 236 rows containing missing values (`geom_point()`).</span></span></code></pre>
<p><img src="knz_bison_vignette_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="explore-use-model-outputs-with-broom">Explore &amp; use model outputs with <code>broom</code><a class="anchor" aria-label="anchor" href="#explore-use-model-outputs-with-broom"></a>
</h2>
<p>The wonderful <a href="https://broom.tidymodels.org/" class="external-link"><code>broom</code> package</a>
“summarizes key information about models in tidy tibbles.” For example,
the <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">broom::tidy()</a></code> function summarizes important model
information:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Put model outputs into a tidy tibble: </span></span>
<span><span class="va">bison_f_gompertz_tidy</span> <span class="op">&lt;-</span> <span class="va">bison_f_gompertz</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check it out! </span></span>
<span><span class="va">bison_f_gompertz_tidy</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">##   term  estimate std.error statistic   p.value</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> b1    <span style="text-decoration: underline;">1</span>010.      1.90        531.  0   <span style="color: #949494;"> </span>    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> b2       0.728   0.007<span style="text-decoration: underline;">55</span>      96.4 0   <span style="color: #949494;"> </span>    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> b3       0.283   0.008<span style="text-decoration: underline;">06</span>      35.1 4.76<span style="color: #949494;">e</span><span style="color: #BB0000;">-242</span></span></span></code></pre>
<p>We can also use the <code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">broom::glance()</a></code> function to return
important information about the model overall:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bison_f_gompertz</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 9</span></span></span>
<span><span class="co">##   sigma isConv     finTol  logLik    AIC    BIC  deviance df.residual  nobs</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>  81.1 TRUE   0.000<span style="text-decoration: underline;">003</span>10 -<span style="color: #BB0000; text-decoration: underline;">29</span><span style="color: #BB0000;">358.</span> <span style="text-decoration: underline;">58</span>724. <span style="text-decoration: underline;">58</span>750. 33<span style="text-decoration: underline;">206</span>307.        <span style="text-decoration: underline;">5</span>046  <span style="text-decoration: underline;">5</span>049</span></span></code></pre>
<p>We can use <code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">broom::augment()</a></code> to added predicted values
and residuals for each of the existing bison in the <code>bison_f</code>
data frame:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">bison_f_gompertz</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5,049 × 4</span></span></span>
<span><span class="co">##    animal_age animal_weight .fitted .resid</span></span>
<span><span class="co">##         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>         13           890   <span style="text-decoration: underline;">1</span>010. -<span style="color: #BB0000;">120.</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>         11          <span style="text-decoration: underline;">1</span>074   <span style="text-decoration: underline;">1</span>009.   64.7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>         11          <span style="text-decoration: underline;">1</span>060   <span style="text-decoration: underline;">1</span>009.   50.7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>         10           989   <span style="text-decoration: underline;">1</span>009.  -<span style="color: #BB0000;">19.9</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>         10          <span style="text-decoration: underline;">1</span>062   <span style="text-decoration: underline;">1</span>009.   53.1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>          9           978   <span style="text-decoration: underline;">1</span>008.  -<span style="color: #BB0000;">30.0</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>          9          <span style="text-decoration: underline;">1</span>068   <span style="text-decoration: underline;">1</span>008.   60.0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>          9          <span style="text-decoration: underline;">1</span>024   <span style="text-decoration: underline;">1</span>008.   16.0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>          8           978   <span style="text-decoration: underline;">1</span>006.  -<span style="color: #BB0000;">28.1</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>          8          <span style="text-decoration: underline;">1</span>188   <span style="text-decoration: underline;">1</span>006.  182. </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 5,039 more rows</span></span></span></code></pre>
<p><strong>Note:</strong> There are additional <a href="https://portal.edirepository.org/nis/metadataviewer?packageid=knb-lter-knz.78.12" class="external-link">related
datasets for this data package</a>, containing information for the
number of male and female bison per age category and bison maternal
parentage (calves matched to mother by ear tags). We encourage you to
check them out for more analysis opportunities with the Konza Prairie
bison!</p>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
<p>Thank you to Konza Prairie LTER Information Manager Yang Xia for
reviewing this vignette and reaching out to researchers on the project,
and to Konza Prairie LTER Researcher Jeffrey Taylor for providing photos
and sharing additional information on the bison data.</p>
</div>
<div class="section level2">
<h2 id="citations">Citations<a class="anchor" aria-label="anchor" href="#citations"></a>
</h2>
<p>Blair, J. 2021. CBH01 Konza Prairie bison herd information ver 12.
Environmental Data Initiative. <a href="https://doi.org/10.6073/pasta/9c641b35695abc5889edd64c3950517f" class="external-link uri">https://doi.org/10.6073/pasta/9c641b35695abc5889edd64c3950517f</a>
(Accessed 2021-10-18).</p>
<p>Martin, JM and Barboza PS (2020). Decadal heat and drought drive body
size of North American bison (Bison bison) along the Great Plains.
Ecology and Evolution <em>10</em> (1): 336 - 349. <a href="https://doi.org/10.1002/ece3.5898" class="external-link uri">https://doi.org/10.1002/ece3.5898</a>.</p>
<p>Robinson, D, Hayes A and Couch S (2021). broom: Convert Statistical
Objects into Tidy Tibbles. R package version 0.7.8. <a href="https://CRAN.R-project.org/package=broom" class="external-link uri">https://CRAN.R-project.org/package=broom</a></p>
</div>
<div class="section level2">
<h2 id="how-we-processed-the-raw-data">How we processed the raw data<a class="anchor" aria-label="anchor" href="#how-we-processed-the-raw-data"></a>
</h2>
<div class="section level4">
<h4 id="download-the-raw-data-from-edi-org">Download the raw data from EDI.org<a class="anchor" aria-label="anchor" href="#download-the-raw-data-from-edi-org"></a>
</h4>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Attach packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://usethis.r-lib.org" class="external-link">usethis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nceas/metajam" class="external-link">metajam</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save link location for the data package:</span></span>
<span><span class="va">knz_url</span> <span class="op">&lt;-</span> <span class="st">"https://portal.edirepository.org/nis/dataviewer?packageid=knb-lter-knz.78.12&amp;entityid=0921d9c31d67badeb940f7352886134e"</span></span>
<span></span>
<span><span class="co"># Download the data package with metajam</span></span>
<span><span class="va">knz_download</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metajam/man/download_d1_data.html" class="external-link">download_d1_data</a></span><span class="op">(</span>data_url <span class="op">=</span> <span class="va">knz_url</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, dir_name<span class="op">=</span><span class="st">"knz_bison"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read in data</span></span>
<span><span class="va">knz_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metajam/man/read_d1_files.html" class="external-link">read_d1_files</a></span><span class="op">(</span><span class="va">knz_download</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="data-preparation">Data preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h4>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">knz_bison</span> <span class="op">&lt;-</span> <span class="va">knz_files</span><span class="op">$</span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">rec_type</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://www.allisonhorst.com/" class="external-link">Allison Horst</a>, <a href="https://brunj7.github.io/" class="external-link">Julien Brun</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
